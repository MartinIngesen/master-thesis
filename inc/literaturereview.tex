\chapter{Literature review}
\label{chap:literaturereview}

There exists several different types of software that makes it possible to correlate events in real-time based on log data.

Software based on event correlation commonly referenced in academia today is largely defunct or the source code is unavailable. 

\begin{itemize}
    \item Swatch and 2swatch - defunct, single-threaded. Last updated in 1997?
    \item logsurfer \cite{thompson_2017} written in C. Improves upon Swatch.
    \item Simple Event Correlator (SEC) is still being actively developed to this date. This is the software that is the most prominent in the literature that I have found. I will address that tool in its own separate section under \ref{sec:SEC}.
    \item Variable Temporal Event Correlator (VTEC) - Built custom for log monitoring and correlation at the company Advanced Micro Devices (AMD). Can not find source code. Feature distributed "workers" and a "variable server" that holds state. Written in Perl and the software uses Perl-based rules.
    \item Event Query Language (EQL). Part of Endgame/Elastic. Written in Python. Scales vertically, same as SEC. Implements a Abstract Syntax Tree for Windows Event Logs specifically.
    \item KSQL - Supports correlation based on time in a Kafka queue. Limited to Kafka as queuing technology.
    \item Splunk - One of the most popular Enterprise SIEM solutions. Supports writing "alerts" that allow time-based correlations.
\end{itemize}
There are several other correlation-based systems other than the ones mentioned above, but they employ some form of machine learning or statistical analysis instead of a rule-based approach. This is usually used for anomaly detection or "finding the unknown" in a dataset, which is not the focus of this thesis.

\section{Simple Event Correlator}
\label{sec:SEC}

In the research that I have found, SEC is the most commonly referenced and used software for event correlation across different syslog events. It is widely used, and has been deployed in several different sectors and industries (Finance, Telecom, IT security, Government, Retail, etc. \cite{vaarandi2005tools}) and utilized for several different purposes like fraud detection, insider-threat detection, system fault and availability and security events. SEC is quite versatile, as it is agnostic to the type of log event that it receives. SEC uses rules that are using Perl-style regular expressions for matching events and extracting data from the event itself using sub-expressions. The extracted data can then be used to correlate between other matching events.

However, even though SEC is popular and commonly used, there are several improvements that could be done. Some of the constraints include:
\begin{itemize}
    \item Heavily based on regular expressions for writing rules, which makes it both hard to analyze rules, modifying existing rules and writing new rules.
    \item Current version can only be scaled vertically. The context-state used for correlation is per-process only and therefore any and all correlation between events have to happen in the same process. It is possible to use SEC in a multi-process fashion to handle separate log types, but this removes the possibility to correlate between those log types. 
    \item Few open source rules and rule-sets. The analyst generally has to start from scratch writing their own rules
    \item Limited support for multi-line logs
    \item Windows Event Logs has to be converted to syslog
    \item Made generic, not specific for Windows Event Logs
\end{itemize}